import{h as Z,c as ee,g as te,b as ne}from"./@babel-179c1243.js";import{T as ae}from"./@rc-component-ae1e168c.js";import{c as F}from"./classnames-b6baddbd.js";import{l as re,K as S,f as L,s as W}from"./rc-util-f8219cd0.js";import{_ as oe,p as ie,N as le,F as se,w as n}from"./preact-23a6e7b2.js";var fe=S.ESC,ue=S.TAB;function ce(e){var u=e.visible,o=e.triggerRef,s=e.onVisibleChange,c=e.autoFocus,a=e.overlayRef,r=oe(!1),f=function(){if(u){var t,i;(t=o.current)===null||t===void 0||(i=t.focus)===null||i===void 0||i.call(t),s==null||s(!1)}},p=function(){var t;return(t=a.current)!==null&&t!==void 0&&t.focus?(a.current.focus(),r.current=!0,!0):!1},h=function(t){switch(t.keyCode){case fe:f();break;case ue:{var i=!1;r.current||(i=p()),i?t.preventDefault():f();break}}};ie(function(){return u?(window.addEventListener("keydown",h),c&&re(p,3),function(){window.removeEventListener("keydown",h),r.current=!1}):function(){r.current=!1}},[u])}var ve=le(function(e,u){var o=e.overlay,s=e.arrow,c=e.prefixCls,a=se(function(){var f;return typeof o=="function"?f=o():f=o,f},[o]),r=L(u,a==null?void 0:a.ref);return n.createElement(n.Fragment,null,s&&n.createElement("div",{className:"".concat(c,"-arrow")}),n.cloneElement(a,{ref:W(a)?r:void 0}))}),v={adjustX:1,adjustY:1},d=[0,0],de={topLeft:{points:["bl","tl"],overflow:v,offset:[0,-4],targetOffset:d},top:{points:["bc","tc"],overflow:v,offset:[0,-4],targetOffset:d},topRight:{points:["br","tr"],overflow:v,offset:[0,-4],targetOffset:d},bottomLeft:{points:["tl","bl"],overflow:v,offset:[0,4],targetOffset:d},bottom:{points:["tc","bc"],overflow:v,offset:[0,4],targetOffset:d},bottomRight:{points:["tr","br"],overflow:v,offset:[0,4],targetOffset:d}},me=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function ge(e,u){var o,s=e.arrow,c=s===void 0?!1:s,a=e.prefixCls,r=a===void 0?"rc-dropdown":a,f=e.transitionName,p=e.animation,h=e.align,m=e.placement,t=m===void 0?"bottomLeft":m,i=e.placements,D=i===void 0?de:i,_=e.getPopupContainer,j=e.showAction,K=e.hideAction,$=e.overlayClassName,B=e.overlayStyle,H=e.visible,N=e.trigger,R=N===void 0?["hover"]:N,I=e.autoFocus,A=e.overlay,y=e.children,b=e.onVisibleChange,X=Z(e,me),Y=n.useState(),M=ee(Y,2),q=M[0],E=M[1],w="visible"in e?H:q,x=n.useRef(null),P=n.useRef(null),T=n.useRef(null);n.useImperativeHandle(u,function(){return x.current});var V=function(l){E(l),b==null||b(l)};ce({visible:w,triggerRef:T,onVisibleChange:V,autoFocus:I,overlayRef:P});var z=function(l){var C=e.onOverlayClick;E(!1),C&&C(l)},k=function(){return n.createElement(ve,{ref:P,overlay:A,prefixCls:r,arrow:c})},G=function(){return typeof A=="function"?k:k()},J=function(){var l=e.minOverlayWidthMatchTrigger,C=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?l:!C},Q=function(){var l=e.openClassName;return l!==void 0?l:"".concat(r,"-open")},U=n.cloneElement(y,{className:F((o=y.props)===null||o===void 0?void 0:o.className,w&&Q()),ref:W(y)?L(T,y.ref):void 0}),O=K;return!O&&R.indexOf("contextMenu")!==-1&&(O=["click"]),n.createElement(ae,te({builtinPlacements:D},X,{prefixCls:r,ref:x,popupClassName:F($,ne({},"".concat(r,"-show-arrow"),c)),popupStyle:B,action:R,showAction:j,hideAction:O,popupPlacement:t,popupAlign:h,popupTransitionName:f,popupAnimation:p,popupVisible:w,stretch:J()?"minWidth":"",popup:G(),onPopupVisibleChange:V,onPopupClick:z,getPopupContainer:_}),U)}const we=n.forwardRef(ge);export{we as D};
