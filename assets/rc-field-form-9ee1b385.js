import{F as ye,f as fe,s as Oe,y as D,g as De,i as _e,q as J,_ as Y,a as re,h as Ie,c as qe,p as le,N as Ke}from"./preact-0e59a8f0.js";import{e as E,o as ie,p as H,f as N,b as d,d as te,k as ze,l as Ge,a as Ve,q as R,_ as Pe,h as we,g as Ae,c as ne}from"./@babel-38a01a7f.js";import{b as q,q as ee,D as z,E as _,p as Je,y as Ye}from"./rc-util-010eb662.js";import{S as Be}from"./async-validator-dee29e8b.js";var G="RC_FORM_INTERNAL_HOOKS",S=function(){q(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},X=ye({getFieldValue:S,getFieldsValue:S,getFieldError:S,getFieldWarning:S,getFieldsError:S,isFieldsTouched:S,isFieldTouched:S,isFieldValidating:S,isFieldsValidating:S,resetFields:S,setFields:S,setFieldValue:S,setFieldsValue:S,validateFields:S,submit:S,getInternalHooks:function(){return S(),{dispatch:S,initEntityValue:S,registerField:S,useSubscribe:S,setInitialValues:S,destroyForm:S,setCallbacks:S,registerWatch:S,getFields:S,setValidateMessages:S,setPreserve:S,getInitialValue:S}}}),oe=ye(null);function ve(o){return o==null?[]:Array.isArray(o)?o:[o]}function Qe(o){return o&&!!o._init}var U="'${name}' is not a valid ${type}",Le={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:U,method:U,array:U,object:U,number:U,date:U,boolean:U,integer:U,float:U,regexp:U,email:U,url:U,hex:U},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},Ne=Be;function Xe(o,l){return o.replace(/\$\{\w+\}/g,function(r){var t=r.slice(2,-1);return l[t]})}var $e="CODE_LOGIC_ERROR";function ge(o,l,r,t,e){return he.apply(this,arguments)}function he(){return he=ie(H().mark(function o(l,r,t,e,n){var a,c,u,s,i,f,v,w,P;return H().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return a=E({},t),delete a.ruleIndex,Ne.warning=function(){},a.validator&&(c=a.validator,a.validator=function(){try{return c.apply(void 0,arguments)}catch(p){return console.error(p),Promise.reject($e)}}),u=null,a&&a.type==="array"&&a.defaultField&&(u=a.defaultField,delete a.defaultField),s=new Ne(d({},l,[a])),i=ee(Le,e.validateMessages),s.messages(i),f=[],h.prev=10,h.next=13,Promise.resolve(s.validate(d({},l,r),E({},e)));case 13:h.next=18;break;case 15:h.prev=15,h.t0=h.catch(10),h.t0.errors&&(f=h.t0.errors.map(function(p,g){var F=p.message,M=F===$e?i.default:F;return fe(M)?Oe(M,{key:"error_".concat(g)}):M}));case 18:if(!(!f.length&&u)){h.next=23;break}return h.next=21,Promise.all(r.map(function(p,g){return ge("".concat(l,".").concat(g),p,u,e,n)}));case 21:return v=h.sent,h.abrupt("return",v.reduce(function(p,g){return[].concat(N(p),N(g))},[]));case 23:return w=E(E({},t),{},{name:l,enum:(t.enum||[]).join(", ")},n),P=f.map(function(p){return typeof p=="string"?Xe(p,w):p}),h.abrupt("return",P);case 26:case"end":return h.stop()}},o,null,[[10,15]])})),he.apply(this,arguments)}function Ze(o,l,r,t,e,n){var a=o.join("."),c=r.map(function(i,f){var v=i.validator,w=E(E({},i),{},{ruleIndex:f});return v&&(w.validator=function(P,m,h){var p=!1,g=function(){for(var k=arguments.length,b=new Array(k),C=0;C<k;C++)b[C]=arguments[C];Promise.resolve().then(function(){q(!p,"Your validator function has already return a promise. `callback` will be ignored."),p||h.apply(void 0,b)})},F=v(P,m,g);p=F&&typeof F.then=="function"&&typeof F.catch=="function",q(p,"`callback` is deprecated. Please return a promise instead."),p&&F.then(function(){h()}).catch(function(M){h(M||" ")})}),w}).sort(function(i,f){var v=i.warningOnly,w=i.ruleIndex,P=f.warningOnly,m=f.ruleIndex;return!!v==!!P?w-m:v?1:-1}),u;if(e===!0)u=new Promise(function(){var i=ie(H().mark(function f(v,w){var P,m,h;return H().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:P=0;case 1:if(!(P<c.length)){g.next=12;break}return m=c[P],g.next=5,ge(a,l,m,t,n);case 5:if(h=g.sent,!h.length){g.next=9;break}return w([{errors:h,rule:m}]),g.abrupt("return");case 9:P+=1,g.next=1;break;case 12:v([]);case 13:case"end":return g.stop()}},f)}));return function(f,v){return i.apply(this,arguments)}}());else{var s=c.map(function(i){return ge(a,l,i,t,n).then(function(f){return{errors:f,rule:i}})});u=(e?rr(s):er(s)).then(function(i){return Promise.reject(i)})}return u.catch(function(i){return i}),u}function er(o){return me.apply(this,arguments)}function me(){return me=ie(H().mark(function o(l){return H().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(l).then(function(e){var n,a=(n=[]).concat.apply(n,N(e));return a}));case 1:case"end":return t.stop()}},o)})),me.apply(this,arguments)}function rr(o){return pe.apply(this,arguments)}function pe(){return pe=ie(H().mark(function o(l){var r;return H().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,e.abrupt("return",new Promise(function(n){l.forEach(function(a){a.then(function(c){c.errors.length&&n([c]),r+=1,r===l.length&&n([])})})}));case 2:case"end":return e.stop()}},o)})),pe.apply(this,arguments)}function I(o){return ve(o)}function Re(o,l){var r={};return l.forEach(function(t){var e=z(o,t);r=_(r,t,e)}),r}function Q(o,l){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return o&&o.some(function(t){return Ue(l,t,r)})}function Ue(o,l){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!o||!l||!r&&o.length!==l.length?!1:l.every(function(t,e){return o[e]===t})}function tr(o,l){if(o===l)return!0;if(!o&&l||o&&!l||!o||!l||te(o)!=="object"||te(l)!=="object")return!1;var r=Object.keys(o),t=Object.keys(l),e=new Set([].concat(r,t));return N(e).every(function(n){var a=o[n],c=l[n];return typeof a=="function"&&typeof c=="function"?!0:a===c})}function nr(o){var l=arguments.length<=1?void 0:arguments[1];return l&&l.target&&te(l.target)==="object"&&o in l.target?l.target[o]:l}function Me(o,l,r){var t=o.length;if(l<0||l>=t||r<0||r>=t)return o;var e=o[l],n=l-r;return n>0?[].concat(N(o.slice(0,r)),[e],N(o.slice(r,l)),N(o.slice(l+1,t))):n<0?[].concat(N(o.slice(0,l)),N(o.slice(l+1,r+1)),[e],N(o.slice(r+1,t))):o}var ir=["name"],W=[];function Se(o,l,r,t,e,n){return typeof o=="function"?o(l,r,"source"in n?{source:n.source}:{}):t!==e}var be=function(o){ze(r,o);var l=Ge(r);function r(t){var e;if(Ve(this,r),e=l.call(this,t),d(R(e),"state",{resetCount:0}),d(R(e),"cancelRegisterFunc",null),d(R(e),"mounted",!1),d(R(e),"touched",!1),d(R(e),"dirty",!1),d(R(e),"validatePromise",void 0),d(R(e),"prevValidating",void 0),d(R(e),"errors",W),d(R(e),"warnings",W),d(R(e),"cancelRegister",function(){var u=e.props,s=u.preserve,i=u.isListField,f=u.name;e.cancelRegisterFunc&&e.cancelRegisterFunc(i,s,I(f)),e.cancelRegisterFunc=null}),d(R(e),"getNamePath",function(){var u=e.props,s=u.name,i=u.fieldContext,f=i.prefixName,v=f===void 0?[]:f;return s!==void 0?[].concat(N(v),N(s)):[]}),d(R(e),"getRules",function(){var u=e.props,s=u.rules,i=s===void 0?[]:s,f=u.fieldContext;return i.map(function(v){return typeof v=="function"?v(f):v})}),d(R(e),"refresh",function(){e.mounted&&e.setState(function(u){var s=u.resetCount;return{resetCount:s+1}})}),d(R(e),"metaCache",null),d(R(e),"triggerMetaEvent",function(u){var s=e.props.onMetaChange;if(s){var i=E(E({},e.getMeta()),{},{destroy:u});Je(e.metaCache,i)||s(i),e.metaCache=i}else e.metaCache=null}),d(R(e),"onStoreChange",function(u,s,i){var f=e.props,v=f.shouldUpdate,w=f.dependencies,P=w===void 0?[]:w,m=f.onReset,h=i.store,p=e.getNamePath(),g=e.getValue(u),F=e.getValue(h),M=s&&Q(s,p);switch(i.type==="valueUpdate"&&i.source==="external"&&g!==F&&(e.touched=!0,e.dirty=!0,e.validatePromise=null,e.errors=W,e.warnings=W,e.triggerMetaEvent()),i.type){case"reset":if(!s||M){e.touched=!1,e.dirty=!1,e.validatePromise=void 0,e.errors=W,e.warnings=W,e.triggerMetaEvent(),m==null||m(),e.refresh();return}break;case"remove":{if(v){e.reRender();return}break}case"setField":{var k=i.data;if(M){"touched"in k&&(e.touched=k.touched),"validating"in k&&!("originRCField"in k)&&(e.validatePromise=k.validating?Promise.resolve([]):null),"errors"in k&&(e.errors=k.errors||W),"warnings"in k&&(e.warnings=k.warnings||W),e.dirty=!0,e.triggerMetaEvent(),e.reRender();return}else if("value"in k&&Q(s,p,!0)){e.reRender();return}if(v&&!p.length&&Se(v,u,h,g,F,i)){e.reRender();return}break}case"dependenciesUpdate":{var b=P.map(I);if(b.some(function(C){return Q(i.relatedFields,C)})){e.reRender();return}break}default:if(M||(!P.length||p.length||v)&&Se(v,u,h,g,F,i)){e.reRender();return}break}v===!0&&e.reRender()}),d(R(e),"validateRules",function(u){var s=e.getNamePath(),i=e.getValue(),f=u||{},v=f.triggerName,w=f.validateOnly,P=w===void 0?!1:w,m=Promise.resolve().then(ie(H().mark(function h(){var p,g,F,M,k,b,C;return H().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e.mounted){y.next=2;break}return y.abrupt("return",[]);case 2:if(p=e.props,g=p.validateFirst,F=g===void 0?!1:g,M=p.messageVariables,k=p.validateDebounce,b=e.getRules(),v&&(b=b.filter(function(V){return V}).filter(function(V){var $=V.validateTrigger;if(!$)return!0;var T=ve($);return T.includes(v)})),!(k&&v)){y.next=10;break}return y.next=8,new Promise(function(V){setTimeout(V,k)});case 8:if(e.validatePromise===m){y.next=10;break}return y.abrupt("return",[]);case 10:return C=Ze(s,i,b,u,F,M),C.catch(function(V){return V}).then(function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W;if(e.validatePromise===m){var $;e.validatePromise=null;var T=[],O=[];($=V.forEach)===null||$===void 0||$.call(V,function(L){var j=L.rule.warningOnly,Z=L.errors,se=Z===void 0?W:Z;j?O.push.apply(O,N(se)):T.push.apply(T,N(se))}),e.errors=T,e.warnings=O,e.triggerMetaEvent(),e.reRender()}}),y.abrupt("return",C);case 13:case"end":return y.stop()}},h)})));return P||(e.validatePromise=m,e.dirty=!0,e.errors=W,e.warnings=W,e.triggerMetaEvent(),e.reRender()),m}),d(R(e),"isFieldValidating",function(){return!!e.validatePromise}),d(R(e),"isFieldTouched",function(){return e.touched}),d(R(e),"isFieldDirty",function(){if(e.dirty||e.props.initialValue!==void 0)return!0;var u=e.props.fieldContext,s=u.getInternalHooks(G),i=s.getInitialValue;return i(e.getNamePath())!==void 0}),d(R(e),"getErrors",function(){return e.errors}),d(R(e),"getWarnings",function(){return e.warnings}),d(R(e),"isListField",function(){return e.props.isListField}),d(R(e),"isList",function(){return e.props.isList}),d(R(e),"isPreserve",function(){return e.props.preserve}),d(R(e),"getMeta",function(){e.prevValidating=e.isFieldValidating();var u={touched:e.isFieldTouched(),validating:e.prevValidating,errors:e.errors,warnings:e.warnings,name:e.getNamePath(),validated:e.validatePromise===null};return u}),d(R(e),"getOnlyChild",function(u){if(typeof u=="function"){var s=e.getMeta();return E(E({},e.getOnlyChild(u(e.getControlled(),s,e.props.fieldContext))),{},{isFunction:!0})}var i=Ye(u);return i.length!==1||!fe(i[0])?{child:i,isFunction:!1}:{child:i[0],isFunction:!1}}),d(R(e),"getValue",function(u){var s=e.props.fieldContext.getFieldsValue,i=e.getNamePath();return z(u||s(!0),i)}),d(R(e),"getControlled",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=e.props,i=s.trigger,f=s.validateTrigger,v=s.getValueFromEvent,w=s.normalize,P=s.valuePropName,m=s.getValueProps,h=s.fieldContext,p=f!==void 0?f:h.validateTrigger,g=e.getNamePath(),F=h.getInternalHooks,M=h.getFieldsValue,k=F(G),b=k.dispatch,C=e.getValue(),A=m||function(T){return d({},P,T)},y=u[i],V=E(E({},u),A(C));V[i]=function(){e.touched=!0,e.dirty=!0,e.triggerMetaEvent();for(var T,O=arguments.length,L=new Array(O),j=0;j<O;j++)L[j]=arguments[j];v?T=v.apply(void 0,L):T=nr.apply(void 0,[P].concat(L)),w&&(T=w(T,C,M(!0))),b({type:"updateValue",namePath:g,value:T}),y&&y.apply(void 0,L)};var $=ve(p||[]);return $.forEach(function(T){var O=V[T];V[T]=function(){O&&O.apply(void 0,arguments);var L=e.props.rules;L&&L.length&&b({type:"validateField",namePath:g,triggerName:T})}}),V}),t.fieldContext){var n=t.fieldContext.getInternalHooks,a=n(G),c=a.initEntityValue;c(R(e))}return e}return Pe(r,[{key:"componentDidMount",value:function(){var e=this.props,n=e.shouldUpdate,a=e.fieldContext;if(this.mounted=!0,a){var c=a.getInternalHooks,u=c(G),s=u.registerField;this.cancelRegisterFunc=s(this)}n===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var e=this.state.resetCount,n=this.props.children,a=this.getOnlyChild(n),c=a.child,u=a.isFunction,s;return u?s=c:fe(c)?s=Oe(c,this.getControlled(c.props)):(q(!c,"`children` of Field is not validate ReactElement."),s=c),D(De,{key:e},s)}}]),r}(_e);d(be,"contextType",X);d(be,"defaultProps",{trigger:"onChange",valuePropName:"value"});function We(o){var l=o.name,r=we(o,ir),t=J(X),e=J(oe),n=l!==void 0?I(l):void 0,a="keep";return r.isListField||(a="_".concat((n||[]).join("_"))),D(be,Ae({key:a,name:n,isListField:!!e},r,{fieldContext:t}))}function ar(o){var l=o.name,r=o.initialValue,t=o.children,e=o.rules,n=o.validateTrigger,a=o.isListField,c=J(X),u=J(oe),s=Y({keys:[],id:0}),i=s.current,f=re(function(){var m=I(c.prefixName)||[];return[].concat(N(m),N(I(l)))},[c.prefixName,l]),v=re(function(){return E(E({},c),{},{prefixName:f})},[c,f]),w=re(function(){return{getKey:function(h){var p=f.length,g=h[p];return[i.keys[g],h.slice(p+1)]}}},[f]);if(typeof t!="function")return q(!1,"Form.List only accepts function as children."),null;var P=function(h,p,g){var F=g.source;return F==="internal"?!1:h!==p};return D(oe.Provider,{value:w},D(X.Provider,{value:v},D(We,{name:[],shouldUpdate:P,rules:e,validateTrigger:n,initialValue:r,isList:!0,isListField:a??!!u},function(m,h){var p=m.value,g=p===void 0?[]:p,F=m.onChange,M=c.getFieldValue,k=function(){var y=M(f||[]);return y||[]},b={add:function(y,V){var $=k();V>=0&&V<=$.length?(i.keys=[].concat(N(i.keys.slice(0,V)),[i.id],N(i.keys.slice(V))),F([].concat(N($.slice(0,V)),[y],N($.slice(V))))):(i.keys=[].concat(N(i.keys),[i.id]),F([].concat(N($),[y]))),i.id+=1},remove:function(y){var V=k(),$=new Set(Array.isArray(y)?y:[y]);$.size<=0||(i.keys=i.keys.filter(function(T,O){return!$.has(O)}),F(V.filter(function(T,O){return!$.has(O)})))},move:function(y,V){if(y!==V){var $=k();y<0||y>=$.length||V<0||V>=$.length||(i.keys=Me(i.keys,y,V),F(Me($,y,V)))}}},C=g||[];return Array.isArray(C)||(C=[]),t(C.map(function(A,y){var V=i.keys[y];return V===void 0&&(i.keys[y]=i.id,V=i.keys[y],i.id+=1),{name:y,key:V,isListField:!0}}),b,h)})))}function sr(o){var l=!1,r=o.length,t=[];return o.length?new Promise(function(e,n){o.forEach(function(a,c){a.catch(function(u){return l=!0,u}).then(function(u){r-=1,t[c]=u,!(r>0)&&(l&&n(t),e(t))})})}):Promise.resolve([])}var xe="__@field_split__";function ce(o){return o.map(function(l){return"".concat(te(l),":").concat(l)}).join(xe)}var B=function(){function o(){Ve(this,o),d(this,"kvs",new Map)}return Pe(o,[{key:"set",value:function(r,t){this.kvs.set(ce(r),t)}},{key:"get",value:function(r){return this.kvs.get(ce(r))}},{key:"update",value:function(r,t){var e=this.get(r),n=t(e);n?this.set(r,n):this.delete(r)}},{key:"delete",value:function(r){this.kvs.delete(ce(r))}},{key:"map",value:function(r){return N(this.kvs.entries()).map(function(t){var e=ne(t,2),n=e[0],a=e[1],c=n.split(xe);return r({key:c.map(function(u){var s=u.match(/^([^:]*):(.*)$/),i=ne(s,3),f=i[1],v=i[2];return f==="number"?Number(v):v}),value:a})})}},{key:"toJSON",value:function(){var r={};return this.map(function(t){var e=t.key,n=t.value;return r[e.join(".")]=n,null}),r}}]),o}(),ur=["name"],lr=Pe(function o(l){var r=this;Ve(this,o),d(this,"formHooked",!1),d(this,"forceRootUpdate",void 0),d(this,"subscribable",!0),d(this,"store",{}),d(this,"fieldEntities",[]),d(this,"initialValues",{}),d(this,"callbacks",{}),d(this,"validateMessages",null),d(this,"preserve",null),d(this,"lastValidatePromise",null),d(this,"getForm",function(){return{getFieldValue:r.getFieldValue,getFieldsValue:r.getFieldsValue,getFieldError:r.getFieldError,getFieldWarning:r.getFieldWarning,getFieldsError:r.getFieldsError,isFieldsTouched:r.isFieldsTouched,isFieldTouched:r.isFieldTouched,isFieldValidating:r.isFieldValidating,isFieldsValidating:r.isFieldsValidating,resetFields:r.resetFields,setFields:r.setFields,setFieldValue:r.setFieldValue,setFieldsValue:r.setFieldsValue,validateFields:r.validateFields,submit:r.submit,_init:!0,getInternalHooks:r.getInternalHooks}}),d(this,"getInternalHooks",function(t){return t===G?(r.formHooked=!0,{dispatch:r.dispatch,initEntityValue:r.initEntityValue,registerField:r.registerField,useSubscribe:r.useSubscribe,setInitialValues:r.setInitialValues,destroyForm:r.destroyForm,setCallbacks:r.setCallbacks,setValidateMessages:r.setValidateMessages,getFields:r.getFields,setPreserve:r.setPreserve,getInitialValue:r.getInitialValue,registerWatch:r.registerWatch}):(q(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),d(this,"useSubscribe",function(t){r.subscribable=t}),d(this,"prevWithoutPreserves",null),d(this,"setInitialValues",function(t,e){if(r.initialValues=t||{},e){var n,a=ee(t,r.store);(n=r.prevWithoutPreserves)===null||n===void 0||n.map(function(c){var u=c.key;a=_(a,u,z(t,u))}),r.prevWithoutPreserves=null,r.updateStore(a)}}),d(this,"destroyForm",function(){var t=new B;r.getFieldEntities(!0).forEach(function(e){r.isMergedPreserve(e.isPreserve())||t.set(e.getNamePath(),!0)}),r.prevWithoutPreserves=t}),d(this,"getInitialValue",function(t){var e=z(r.initialValues,t);return t.length?ee(e):e}),d(this,"setCallbacks",function(t){r.callbacks=t}),d(this,"setValidateMessages",function(t){r.validateMessages=t}),d(this,"setPreserve",function(t){r.preserve=t}),d(this,"watchList",[]),d(this,"registerWatch",function(t){return r.watchList.push(t),function(){r.watchList=r.watchList.filter(function(e){return e!==t})}}),d(this,"notifyWatch",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(r.watchList.length){var e=r.getFieldsValue(),n=r.getFieldsValue(!0);r.watchList.forEach(function(a){a(e,n,t)})}}),d(this,"timeoutId",null),d(this,"warningUnhooked",function(){}),d(this,"updateStore",function(t){r.store=t}),d(this,"getFieldEntities",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return t?r.fieldEntities.filter(function(e){return e.getNamePath().length}):r.fieldEntities}),d(this,"getFieldsMap",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=new B;return r.getFieldEntities(t).forEach(function(n){var a=n.getNamePath();e.set(a,n)}),e}),d(this,"getFieldEntitiesForNamePathList",function(t){if(!t)return r.getFieldEntities(!0);var e=r.getFieldsMap(!0);return t.map(function(n){var a=I(n);return e.get(a)||{INVALIDATE_NAME_PATH:I(n)}})}),d(this,"getFieldsValue",function(t,e){r.warningUnhooked();var n,a,c;if(t===!0||Array.isArray(t)?(n=t,a=e):t&&te(t)==="object"&&(c=t.strict,a=t.filter),n===!0&&!a)return r.store;var u=r.getFieldEntitiesForNamePathList(Array.isArray(n)?n:null),s=[];return u.forEach(function(i){var f,v,w="INVALIDATE_NAME_PATH"in i?i.INVALIDATE_NAME_PATH:i.getNamePath();if(c){var P,m;if((P=(m=i).isList)!==null&&P!==void 0&&P.call(m))return}else if(!n&&(f=(v=i).isListField)!==null&&f!==void 0&&f.call(v))return;if(!a)s.push(w);else{var h="getMeta"in i?i.getMeta():null;a(h)&&s.push(w)}}),Re(r.store,s.map(I))}),d(this,"getFieldValue",function(t){r.warningUnhooked();var e=I(t);return z(r.store,e)}),d(this,"getFieldsError",function(t){r.warningUnhooked();var e=r.getFieldEntitiesForNamePathList(t);return e.map(function(n,a){return n&&!("INVALIDATE_NAME_PATH"in n)?{name:n.getNamePath(),errors:n.getErrors(),warnings:n.getWarnings()}:{name:I(t[a]),errors:[],warnings:[]}})}),d(this,"getFieldError",function(t){r.warningUnhooked();var e=I(t),n=r.getFieldsError([e])[0];return n.errors}),d(this,"getFieldWarning",function(t){r.warningUnhooked();var e=I(t),n=r.getFieldsError([e])[0];return n.warnings}),d(this,"isFieldsTouched",function(){r.warningUnhooked();for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=e[0],c=e[1],u,s=!1;e.length===0?u=null:e.length===1?Array.isArray(a)?(u=a.map(I),s=!1):(u=null,s=a):(u=a.map(I),s=c);var i=r.getFieldEntities(!0),f=function(h){return h.isFieldTouched()};if(!u)return s?i.every(f):i.some(f);var v=new B;u.forEach(function(m){v.set(m,[])}),i.forEach(function(m){var h=m.getNamePath();u.forEach(function(p){p.every(function(g,F){return h[F]===g})&&v.update(p,function(g){return[].concat(N(g),[m])})})});var w=function(h){return h.some(f)},P=v.map(function(m){var h=m.value;return h});return s?P.every(w):P.some(w)}),d(this,"isFieldTouched",function(t){return r.warningUnhooked(),r.isFieldsTouched([t])}),d(this,"isFieldsValidating",function(t){r.warningUnhooked();var e=r.getFieldEntities();if(!t)return e.some(function(a){return a.isFieldValidating()});var n=t.map(I);return e.some(function(a){var c=a.getNamePath();return Q(n,c)&&a.isFieldValidating()})}),d(this,"isFieldValidating",function(t){return r.warningUnhooked(),r.isFieldsValidating([t])}),d(this,"resetWithFieldInitialValue",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new B,n=r.getFieldEntities(!0);n.forEach(function(u){var s=u.props.initialValue,i=u.getNamePath();if(s!==void 0){var f=e.get(i)||new Set;f.add({entity:u,value:s}),e.set(i,f)}});var a=function(s){s.forEach(function(i){var f=i.props.initialValue;if(f!==void 0){var v=i.getNamePath(),w=r.getInitialValue(v);if(w!==void 0)q(!1,"Form already set 'initialValues' with path '".concat(v.join("."),"'. Field can not overwrite it."));else{var P=e.get(v);if(P&&P.size>1)q(!1,"Multiple Field with path '".concat(v.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(P){var m=r.getFieldValue(v),h=i.isListField();!h&&(!t.skipExist||m===void 0)&&r.updateStore(_(r.store,v,N(P)[0].value))}}}})},c;t.entities?c=t.entities:t.namePathList?(c=[],t.namePathList.forEach(function(u){var s=e.get(u);if(s){var i;(i=c).push.apply(i,N(N(s).map(function(f){return f.entity})))}})):c=n,a(c)}),d(this,"resetFields",function(t){r.warningUnhooked();var e=r.store;if(!t){r.updateStore(ee(r.initialValues)),r.resetWithFieldInitialValue(),r.notifyObservers(e,null,{type:"reset"}),r.notifyWatch();return}var n=t.map(I);n.forEach(function(a){var c=r.getInitialValue(a);r.updateStore(_(r.store,a,c))}),r.resetWithFieldInitialValue({namePathList:n}),r.notifyObservers(e,n,{type:"reset"}),r.notifyWatch(n)}),d(this,"setFields",function(t){r.warningUnhooked();var e=r.store,n=[];t.forEach(function(a){var c=a.name,u=we(a,ur),s=I(c);n.push(s),"value"in u&&r.updateStore(_(r.store,s,u.value)),r.notifyObservers(e,[s],{type:"setField",data:a})}),r.notifyWatch(n)}),d(this,"getFields",function(){var t=r.getFieldEntities(!0),e=t.map(function(n){var a=n.getNamePath(),c=n.getMeta(),u=E(E({},c),{},{name:a,value:r.getFieldValue(a)});return Object.defineProperty(u,"originRCField",{value:!0}),u});return e}),d(this,"initEntityValue",function(t){var e=t.props.initialValue;if(e!==void 0){var n=t.getNamePath(),a=z(r.store,n);a===void 0&&r.updateStore(_(r.store,n,e))}}),d(this,"isMergedPreserve",function(t){var e=t!==void 0?t:r.preserve;return e??!0}),d(this,"registerField",function(t){r.fieldEntities.push(t);var e=t.getNamePath();if(r.notifyWatch([e]),t.props.initialValue!==void 0){var n=r.store;r.resetWithFieldInitialValue({entities:[t],skipExist:!0}),r.notifyObservers(n,[t.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(a,c){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(r.fieldEntities=r.fieldEntities.filter(function(f){return f!==t}),!r.isMergedPreserve(c)&&(!a||u.length>1)){var s=a?void 0:r.getInitialValue(e);if(e.length&&r.getFieldValue(e)!==s&&r.fieldEntities.every(function(f){return!Ue(f.getNamePath(),e)})){var i=r.store;r.updateStore(_(i,e,s,!0)),r.notifyObservers(i,[e],{type:"remove"}),r.triggerDependenciesUpdate(i,e)}}r.notifyWatch([e])}}),d(this,"dispatch",function(t){switch(t.type){case"updateValue":{var e=t.namePath,n=t.value;r.updateValue(e,n);break}case"validateField":{var a=t.namePath,c=t.triggerName;r.validateFields([a],{triggerName:c});break}}}),d(this,"notifyObservers",function(t,e,n){if(r.subscribable){var a=E(E({},n),{},{store:r.getFieldsValue(!0)});r.getFieldEntities().forEach(function(c){var u=c.onStoreChange;u(t,e,a)})}else r.forceRootUpdate()}),d(this,"triggerDependenciesUpdate",function(t,e){var n=r.getDependencyChildrenFields(e);return n.length&&r.validateFields(n),r.notifyObservers(t,n,{type:"dependenciesUpdate",relatedFields:[e].concat(N(n))}),n}),d(this,"updateValue",function(t,e){var n=I(t),a=r.store;r.updateStore(_(r.store,n,e)),r.notifyObservers(a,[n],{type:"valueUpdate",source:"internal"}),r.notifyWatch([n]);var c=r.triggerDependenciesUpdate(a,n),u=r.callbacks.onValuesChange;if(u){var s=Re(r.store,[n]);u(s,r.getFieldsValue())}r.triggerOnFieldsChange([n].concat(N(c)))}),d(this,"setFieldsValue",function(t){r.warningUnhooked();var e=r.store;if(t){var n=ee(r.store,t);r.updateStore(n)}r.notifyObservers(e,null,{type:"valueUpdate",source:"external"}),r.notifyWatch()}),d(this,"setFieldValue",function(t,e){r.setFields([{name:t,value:e}])}),d(this,"getDependencyChildrenFields",function(t){var e=new Set,n=[],a=new B;r.getFieldEntities().forEach(function(u){var s=u.props.dependencies;(s||[]).forEach(function(i){var f=I(i);a.update(f,function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return v.add(u),v})})});var c=function u(s){var i=a.get(s)||new Set;i.forEach(function(f){if(!e.has(f)){e.add(f);var v=f.getNamePath();f.isFieldDirty()&&v.length&&(n.push(v),u(v))}})};return c(t),n}),d(this,"triggerOnFieldsChange",function(t,e){var n=r.callbacks.onFieldsChange;if(n){var a=r.getFields();if(e){var c=new B;e.forEach(function(s){var i=s.name,f=s.errors;c.set(i,f)}),a.forEach(function(s){s.errors=c.get(s.name)||s.errors})}var u=a.filter(function(s){var i=s.name;return Q(t,i)});u.length&&n(u,a)}}),d(this,"validateFields",function(t,e){r.warningUnhooked();var n,a;Array.isArray(t)||typeof t=="string"||typeof e=="string"?(n=t,a=e):a=t;var c=!!n,u=c?n.map(I):[],s=[],i=String(Date.now()),f=new Set,v=a||{},w=v.recursive,P=v.dirty;r.getFieldEntities(!0).forEach(function(g){if(c||u.push(g.getNamePath()),!(!g.props.rules||!g.props.rules.length)&&!(P&&!g.isFieldDirty())){var F=g.getNamePath();if(f.add(F.join(i)),!c||Q(u,F,w)){var M=g.validateRules(E({validateMessages:E(E({},Le),r.validateMessages)},a));s.push(M.then(function(){return{name:F,errors:[],warnings:[]}}).catch(function(k){var b,C=[],A=[];return(b=k.forEach)===null||b===void 0||b.call(k,function(y){var V=y.rule.warningOnly,$=y.errors;V?A.push.apply(A,N($)):C.push.apply(C,N($))}),C.length?Promise.reject({name:F,errors:C,warnings:A}):{name:F,errors:C,warnings:A}}))}}});var m=sr(s);r.lastValidatePromise=m,m.catch(function(g){return g}).then(function(g){var F=g.map(function(M){var k=M.name;return k});r.notifyObservers(r.store,F,{type:"validateFinish"}),r.triggerOnFieldsChange(F,g)});var h=m.then(function(){return r.lastValidatePromise===m?Promise.resolve(r.getFieldsValue(u)):Promise.reject([])}).catch(function(g){var F=g.filter(function(M){return M&&M.errors.length});return Promise.reject({values:r.getFieldsValue(u),errorFields:F,outOfDate:r.lastValidatePromise!==m})});h.catch(function(g){return g});var p=u.filter(function(g){return f.has(g.join(i))});return r.triggerOnFieldsChange(p),h}),d(this,"submit",function(){r.warningUnhooked(),r.validateFields().then(function(t){var e=r.callbacks.onFinish;if(e)try{e(t)}catch(n){console.error(n)}}).catch(function(t){var e=r.callbacks.onFinishFailed;e&&e(t)})}),this.forceRootUpdate=l});function je(o){var l=Y(),r=Ie({}),t=ne(r,2),e=t[1];if(!l.current)if(o)l.current=o;else{var n=function(){e({})},a=new lr(n);l.current=a.getForm()}return[l.current]}var Fe=ye({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),or=function(l){var r=l.validateMessages,t=l.onFormChange,e=l.onFormFinish,n=l.children,a=J(Fe),c=Y({});return D(Fe.Provider,{value:E(E({},a),{},{validateMessages:E(E({},a.validateMessages),r),triggerFormChange:function(s,i){t&&t(s,{changedFields:i,forms:c.current}),a.triggerFormChange(s,i)},triggerFormFinish:function(s,i){e&&e(s,{values:i,forms:c.current}),a.triggerFormFinish(s,i)},registerForm:function(s,i){s&&(c.current=E(E({},c.current),{},d({},s,i))),a.registerForm(s,i)},unregisterForm:function(s){var i=E({},c.current);delete i[s],c.current=i,a.unregisterForm(s)}})},n)},dr=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],cr=function(l,r){var t=l.name,e=l.initialValues,n=l.fields,a=l.form,c=l.preserve,u=l.children,s=l.component,i=s===void 0?"form":s,f=l.validateMessages,v=l.validateTrigger,w=v===void 0?"onChange":v,P=l.onValuesChange,m=l.onFieldsChange,h=l.onFinish,p=l.onFinishFailed,g=we(l,dr),F=J(Fe),M=je(a),k=ne(M,1),b=k[0],C=b.getInternalHooks(G),A=C.useSubscribe,y=C.setInitialValues,V=C.setCallbacks,$=C.setValidateMessages,T=C.setPreserve,O=C.destroyForm;qe(r,function(){return b}),le(function(){return F.registerForm(t,b),function(){F.unregisterForm(t)}},[F,b,t]),$(E(E({},F.validateMessages),f)),V({onValuesChange:P,onFieldsChange:function(x){if(F.triggerFormChange(t,x),m){for(var K=arguments.length,Ee=new Array(K>1?K-1:0),ue=1;ue<K;ue++)Ee[ue-1]=arguments[ue];m.apply(void 0,[x].concat(Ee))}},onFinish:function(x){F.triggerFormFinish(t,x),h&&h(x)},onFinishFailed:p}),T(c);var L=Y(null);y(e,!L.current),L.current||(L.current=!0),le(function(){return O},[]);var j,Z=typeof u=="function";if(Z){var se=b.getFieldsValue(!0);j=u(se,b)}else j=u;A(!Z);var Ce=Y();le(function(){tr(Ce.current||[],n||[])||b.setFields(n||[]),Ce.current=n},[n,b]);var He=re(function(){return E(E({},b),{},{validateTrigger:w})},[b,w]),ke=D(oe.Provider,{value:null},D(X.Provider,{value:He},j));return i===!1?ke:D(i,Ae({},g,{onSubmit:function(x){x.preventDefault(),x.stopPropagation(),b.submit()},onReset:function(x){var K;x.preventDefault(),b.resetFields(),(K=g.onReset)===null||K===void 0||K.call(g,x)}}),ke)};function Te(o){try{return JSON.stringify(o)}catch{return Math.random()}}function fr(){for(var o=arguments.length,l=new Array(o),r=0;r<o;r++)l[r]=arguments[r];var t=l[0],e=l[1],n=e===void 0?{}:e,a=Qe(n)?{form:n}:n,c=a.form,u=Ie(),s=ne(u,2),i=s[0],f=s[1],v=re(function(){return Te(i)},[i]),w=Y(v);w.current=v;var P=J(X),m=c||P,h=m&&m._init,p=I(t),g=Y(p);return g.current=p,le(function(){if(h){var F=m.getFieldsValue,M=m.getInternalHooks,k=M(G),b=k.registerWatch,C=function($,T){var O=a.preserve?T:$;return typeof t=="function"?t(O):z(O,g.current)},A=b(function(V,$){var T=C(V,$),O=Te(T);w.current!==O&&(w.current=O,f(T))}),y=C(F(),F(!0));return i!==y&&f(y),A}},[h]),i}var vr=Ke(cr),ae=vr;ae.FormProvider=or;ae.Field=We;ae.List=ar;ae.useForm=je;ae.useWatch=fr;export{X as C,or as F,oe as L,ae as R,We as W,ar as a,fr as b,je as u};
